;// bundle: iframelogin___8145f54f11c123103224ba386069cfa5_m
;// files: jquery.ba-postmessage.min.js, iFrameLogin.js, TwoStepVerificationModal.js

;// jquery.ba-postmessage.min.js
/*
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var g,d,j=1,a,b=this,f=!1,h="postMessage",e="addEventListener",c,i=b[h]&&!$.browser.opera;$[h]=function(k,l,m){if(!l){return}k=typeof k==="string"?k:$.param(k);m=m||parent;if(i){m[h](k,l.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(l){m.location=l.replace(/#.*$/,"")+"#"+(+new Date)+(j++)+"&"+k}}};$.receiveMessage=c=function(l,m,k){if(i){if(l){a&&c();a=function(n){if((typeof m==="string"&&n.origin!==m)||($.isFunction(m)&&m(n.origin)===f)){return f}l(n)}}if(b[e]){b[l?e:"removeEventListener"]("message",a,f)}else{b[l?"attachEvent":"detachEvent"]("onmessage",a)}}else{g&&clearInterval(g);g=null;if(l){k=typeof m==="number"?m:typeof k==="number"?k:100;g=setInterval(function(){var o=document.location.hash,n=/^#?\d+&/;if(o!==d&&n.test(o)){d=o;l({data:o.replace(n,"")})}},k)}}}})(jQuery);

;// iFrameLogin.js
typeof Roblox=="undefined"&&(Roblox={}),Roblox.iFrameLogin=new function(){function f(){var p=$(document.body).data("redirecttohttp"),e=$(document.body).data("captchaon"),o=!1,c=!0,a=function(n){var t=$(document.body).data("parent-url");$.postMessage("resize,"+n,t,parent)},s=null;e?a("400px"):a("280px");var v=function(){var n;n=p?$(document.body).data("parent-url"):window.parent.location.href,n.indexOf("#")!=-1&&(n=window.parent.location.href.split("#")[0]),n+=n.indexOf("?")==-1?"?nl=true":"&nl=true",window.parent.location=n},h=function(n){n?($("#LoginButton").hide(),$("#LoggingInStatus").show()):($("#LoginButton").show(),$("#LoggingInStatus").hide())},w=function(){var n=!1,t=[$("#Password"),$("#UserName")];return e&&t.push($("#recaptcha_response_field")),jQuery.each(t,function(){var t=$(this);t.val()==""?(f(t,!0),n=!0):f(t,!1)}),n},f=function(n,t){o=!1,h(!1),t?n.css({"background-color":"#FDD"}):n.css({"background-color":"white"})},y=function(n,t,i,r){var u=Roblox.iFrameLogin.Resources.requestCodeUnauthenticatedPath,f={username:n,password:t,actionType:Roblox.TwoStepVerificationModal.ActionTypes.SignIn};$.ajax({type:"POST",url:u,data:f,crossDomain:!0,xhrFields:{withCredentials:!0},success:i,error:r})},b=function(){var n=function(){var n,t;$("#TwoStepVerificationNewCodeButton").hide(),$("#TwoStepVerificationSubmitButton").show(),n=$("#TwoStepVerificationMessage"),n.text(Roblox.iFrameLogin.Resources.enterTwoStepCodeMessage),t=$("#TwoStepVerificationCodeInput"),t.css("background-color","white")},t=function(n){var i=$("#TwoStepVerificationNewCodeButton"),t=null,r;switch(n.status){case 403:r=JSON.parse(n.responseText),r.message==="Flooded"?(t=Roblox.iFrameLogin.Resources.floodedTwoStepMessage,i.addClass("disabled")):r.message==="VerifyEmail"?(t=Roblox.iFrameLogin.Resources.verifyEmailMessage,i.addClass("disabled")):(t=Roblox.iFrameLogin.Resources.unknownErrorText,i.addClass("disabled"));break;default:t=Roblox.iFrameLogin.Resources.unknownErrorText,i.addClass("disabled")}$("#TwoStepVerificationMessage").text(t)},i=$("#UserName").val();y(i,s,n,t)},k=function(){var n=function(){$("#Password").val(s),l()},t=function(n){var t,r;$("#TwoStepVerificationSubmitButton").hide(),t=$("#TwoStepVerificationNewCodeButton"),t.show();var u=$("#TwoStepVerificationCodeInput"),i=null,f=!1;switch(n.status){case 403:r=JSON.parse(n.responseText),r.message==="Flooded"?(i=Roblox.iFrameLogin.Resources.floodedTwoStepMessage,t.addClass("disabled")):r.message==="VerifyEmail"?(i=Roblox.iFrameLogin.Resources.verifyEmailMessage,t.addClass("disabled")):r.message==="InvalidCode"?(i=Roblox.iFrameLogin.Resources.invalidCodeMessage,f=!0):(i=Roblox.iFrameLogin.Resources.unknownErrorText,t.addClass("disabled"));break;default:i=Roblox.iFrameLogin.Resources.unknownErrorText,t.addClass("disabled")}u.val(""),f&&u.css("background-color","#FDD"),$("#TwoStepVerificationMessage").text(i)},i=Roblox.iFrameLogin.Resources.verifyCodeUnauthenticatedPath,r={username:$("#UserName").val(),password:s,actionType:Roblox.TwoStepVerificationModal.ActionTypes.SignIn,code:$("#TwoStepVerificationCodeInput").val()};$.ajax({type:"POST",url:i,data:r,crossDomain:!0,xhrFields:{withCredentials:!0},success:n,error:t})},l=function(){var a,p,k;if(w())return!1;if(c)return f($("#UserName"),!0),!1;o=!0,h(!0);var g=$("#UserName"),nt=$("#Password"),l=g.val(),b=nt.val();if(s=b,a="",p="",e&&(a=$("#recaptcha_challenge_field").val(),p=$("#recaptcha_response_field").val(),a==""||p==""))return f($("#recaptcha_response_field"),!0),!1;if(e&&$("#Captcha_upBadCaptcha").text(""),Roblox.iFrameLogin.Resources.useSignOnApi){var tt={username:l,password:b,recaptcha_challenge_field:a,recaptcha_response_field:p},k=function(){v()},d=function(n){var t,i,r;if(n.status===403){t=JSON.parse(n.responseText);switch(t.message){case"Credentials":f($("#Password"),!0),$("#NotAMemberLink").hide(),$("#ForgotPasswordLink").show();break;case"CaptchaIncorrect":f($("#Password"),!1),$("#Captcha_upBadCaptcha").show(),$("#Captcha_upBadCaptcha").css("color","red"),$("#Captcha_upBadCaptcha").text(Roblox.iFrameLogin.Resources.invalidCaptchaEntry);break;case"CaptchaMissing":f($("#Password"),!1),$("#Captcha_upBadCaptcha").show(),$("#Captcha_upBadCaptcha").css("color","red");break;case"TwoStepVerification":i=function(){$("#credentials-section").hide(),$("#two-step-verification-section").show()},r=function(n){var t,i;$("#credentials-section").hide(),$("#two-step-verification-section").show(),t=null;switch(n.status){case 403:i=JSON.parse(n.responseText),t=i.message==="Flooded"?Roblox.iFrameLogin.Resources.floodedTwoStepMessage:i.message==="VerifyEmail"?Roblox.iFrameLogin.Resources.verifyEmailMessage:Roblox.iFrameLogin.Resources.unknownErrorText;break;default:t=Roblox.iFrameLogin.Resources.unknownErrorText}$("#TwoStepVerificationMessage").text(t),$("#TwoStepVerificationSubmitButton").addClass("disabled")},y(l,b,i,r)}}return e&&Recaptcha.reload("t"),$("#Password").val(""),$("#Password").focus(),o=!1,h(!1),!1};$.ajax({type:"POST",url:Roblox.iFrameLogin.Resources.signOnApiPath,data:tt,crossDomain:!0,xhrFields:{withCredentials:!0},success:k,error:d})}else k=d=function(s){if(s.IsValid)v();else return s.ErrorCode.indexOf(r)!=-1?(l!=""&&window.location.href.indexOf("username")==-1?window.location.href=window.location.href+"&username="+l:window.location.reload(),!1):(s.ErrorCode.indexOf(t)!=-1&&(window.parent.location="/login/twofactorauth?username="+encodeURIComponent(l)),s.ErrorCode.indexOf(u)!=-1?(f($("#Password"),!0),$("#NotAMemberLink").hide(),$("#ForgotPasswordLink").show()):s.ErrorCode.indexOf(n)!=-1?$("#ErrorMessage").text(s.Message):s.ErrorCode.indexOf(i)!=-1?$("#ErrorMessage").text(s.Message):(f($("#Password"),!1),$("#Captcha_upBadCaptcha").show(),$("#Captcha_upBadCaptcha").css("color","red"),s.Message=="incorrect-captcha-sol"?$("#Captcha_upBadCaptcha").text(Roblox.iFrameLogin.Resources.invalidCaptchaEntry):$("#Captcha_upBadCaptcha").text(s.Message)),e&&Recaptcha.reload("t"),$("#Password").val(""),$("#Password").focus(),o=!1,h(!1),!1)},Roblox.Website.Services.Secure.LoginService.ValidateLogin(l,b,e,a,p,k,d)},d=function(){var n=$("#UserName").val(),t=onError=function(n){f($("#UserName"),!n.success),c=!n.success,n.success||($("#NotAMemberLink").show(),$("#ForgotPasswordLink").hide())};n!=""&&$.ajax({type:"GET",url:"/UserCheck/doesusernameexist?username="+n,success:t,error:onError})};$("#LoginButton").click(function(){l()}),$("#TwoStepVerificationSubmitButton").click(function(){k()}),$("#TwoStepVerificationCancelButton").click(function(){var n,t;$("#TwoStepVerificationNewCodeButton").hide(),n=$("#TwoStepVerificationSubmitButton"),n.show(),n.removeClass("disabled"),$("#TwoStepVerificationMessage").text(Roblox.iFrameLogin.Resources.enterTwoStepCodeMessage),t=$("#TwoStepVerificationCodeInput"),t.val(""),t.css("background-color","white"),$("#two-step-verification-section").hide(),$("#credentials-section").show()}),$("#TwoStepVerificationNewCodeButton").click(function(){b()}),$("#UserName").blur(function(){d()}),$(document).keydown(function(n){if(n.which==13&&!o)return l(),!1}),$(function(){var n=1;$("input,select").each(function(){if(this.type!="hidden"){var t=$(this);t.attr("tabindex",n),n++}})}),$(function(){$("#UserName").val()!=""||$("#UserName").val()!=undefined,c=!1}),$(function(){$("#CaptchaContainer").css({"margin-left":"0","margin-top":"8px","margin-bottom":"5px",width:"none"})})}var e="1",o="2",n="3",t="4",i="5",r="6",u="7",s="8";return{init:f}};

;// TwoStepVerificationModal.js
typeof Roblox=="undefined"&&(Roblox={}),typeof Roblox.TwoStepVerificationModal=="undefined"&&(Roblox.TwoStepVerificationModal=function(){function t(n){switch(n){case Roblox.TwoStepVerificationModal.ActionTypes.SignIn:return!0}return!1}function i(n){var c={actionType:0,onSuccess:null,onError:null},i;n=$.extend({},c,n);var s={titleText:"Enter Verification Code",bodyContent:"Enter the verification code sent to your email.<br/><div id='codeInputValidation' class='validationTooltip'></div><br/><input id='verificationCodeInput' type='text'/>",acceptText:"Submit",onAccept:function(){e(n)},declineText:"Cancel",allowHtmlContentInBody:!0,fieldValidationRequired:!0,onOpenCallback:o},f=null,h=t(n.actionType);if(f=h?$("#TwoStepVerificationApiPaths").data("request-code-unauthenticated"):$("#TwoStepVerificationApiPaths").data("request-code"),i={actionType:n.actionType},h){if(n.username===undefined)throw"'username' required in properties for unauthenticated requests";if(n.password===undefined)throw"'password' required in properties for unauthenticated requests";i.username=n.username,i.password=n.password}$.ajax({type:"POST",url:f,data:i,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(n){var t=r(n.mediaType);s.bodyContent="Enter the verification code sent via "+t+".<br/><div id='codeInputValidation' class='validationTooltip'></div><br/><input id='verificationCodeInput' type='text'/>",Roblox.GenericConfirmation.open(s)},error:u})}function u(t){if(t.getResponseHeader(n)!==null)if(t.status===403){var i=JSON.parse(t.responseText);i.message==="Flooded"?Roblox.GenericModal.open("Slow Down","/images/Icons/img-alert.png","You have tried to do this too many times. Try again later."):i.message==="VerifyEmail"?Roblox.GenericModal.open("Verify Email","/images/Icons/img-alert.png","You must have a verified email address.",function(){window.location.href="/my/account"}):i.message==="EnableTwoStep"?Roblox.GenericModal.open("Disabled","/images/Icons/img-alert.png","You must enable two step verification before requesting a code."):i.message==="Credentials"&&Roblox.GenericModal.open("Invalid Username/Password","/images/Icons/img-alert.png","The username/password combination was incorrect.")}else t.status===404?Roblox.GenericModal.open("Disabled","/images/Icons/img-alert.png","This feature has been disabled."):t.status===500&&Roblox.GenericModal.open("Error","/images/Icons/img-alert.png","Sorry, an unknown error has occured.")}function f(t,i){if(i.getResponseHeader(n)!==null)if(i.status===403){var r=JSON.parse(i.responseText);r.message==="Flooded"?Roblox.GenericModal.open("Slow Down","/images/Icons/img-alert.png","You have tried to do this too many times. Try again later."):r.message==="VerifyEmail"?Roblox.GenericModal.open("Verify Email","/images/Icons/img-alert.png","You must have a verified email address.",function(){window.location.href="/my/account"}):r.message==="EnableTwoStep"?Roblox.GenericModal.open("Disabled","/images/Icons/img-alert.png","You must enable two step verification before requesting a code."):r.message==="Credentials"?Roblox.GenericModal.open("Invalid Username/Password","/images/Icons/img-alert.png","The username/password combination was incorrect."):r.message==="InvalidCode"&&Roblox.GenericModal.open("Code Invalid","/images/Icons/img-alert.png","Sorry, but the code you entered is invalid or has expired.")}else i.status===404?Roblox.GenericModal.open("Disabled","/images/Icons/img-alert.png","This feature has been disabled."):i.status===500&&Roblox.GenericModal.open("Error","/images/Icons/img-alert.png","Sorry, an unknown error has occured.");else if(t.onError!==null&&t.onError!==undefined)t.onError(i)}function e(n){var e=$("#verificationCodeInput").val(),r=null,u=t(n.actionType),i;if(r=u?$("#TwoStepVerificationApiPaths").data("verify-code-unauthenticated"):$("#TwoStepVerificationApiPaths").data("verify-code"),i={code:e,actionType:n.actionType},u){if(n.username===undefined)throw"'username' required in properties for unauthenticated verifications";if(n.password===undefined)throw"'password' required in properties for unauthenticated verifications";i.username=n.username,i.password=n.password}return $.ajax({type:"POST",url:r,data:i,crossDomain:!0,xhrFields:{withCredentials:!0},success:n.onSuccess,error:function(t){f(n,t)}}),!0}function o(){var n="0123456789",t=6;$("#verificationCodeInput").on("input propertychange paste",function(){for(var r=$("#verificationCodeInput").val(),o=!1,e,f,i,u=0;u<r.length;u++){for(e=!1,f=0;f<n.length;f++)if(r.charAt(u)===n.charAt(f)){e=!0;break}if(!e){o=!0;break}}if(i=$("#codeInputValidation"),o){i.text("Contains invalid characters"),i.show();return}if(r.length>0&&r.length<t){i.text("Too short"),i.show();return}if(r.length>t){i.text("Too long"),i.show();return}i.hide()})}var n="Two-Step-Verification",r=function(n){return n==="Sms"?"SMS":n==="Email"?"email":n},s={SignIn:0,PasswordChange:1,EnableTwoStep:2,ChangeEmail:3};$(document).on("keypress","#verificationCodeInput",function(n){if(n.which==13)return Roblox.GenericConfirmation.clickYes(),!1});return{open:i,ActionTypes:s}}());
